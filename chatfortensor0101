--[[
  RAGE Chat by tensor0101
  - Чат, сворачивание, мигающая обводка
  - Уведомления внизу справа + звук при отправке
  - Полностью рабочий код
]]--

local player = game:GetService("Players").LocalPlayer
local gui = Instance.new("ScreenGui")
gui.Name = "RageChatFinal"
gui.Parent = player:WaitForChild("PlayerGui")
gui.ResetOnSpawn = false

local Tween = game:GetService("TweenService")
local sound = Instance.new("Sound")
sound.SoundId = "rbxasset://sounds/notification.mp3"
sound.Volume = 0.5
sound.Parent = gui

local origSize = UDim2.new(0, 500, 0, 350)
local minSize = UDim2.new(0, 500, 0, 40)
local isMin = false

local frame = Instance.new("Frame")
frame.Size = origSize
frame.Position = UDim2.new(0.5, -250, 0.5, -175)
frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
frame.BackgroundTransparency = 0.2
frame.Active = true
frame.Draggable = true
frame.Parent = gui

local border = Instance.new("Frame")
border.Size = UDim2.new(1, 6, 1, 6)
border.Position = UDim2.new(0, -3, 0, -3)
border.BackgroundTransparency = 1
border.BorderSizePixel = 2
border.BorderColor3 = Color3.fromRGB(255,255,255)
border.BorderTransparency = 0.5
border.Parent = frame

coroutine.wrap(function()
    while border do
        for _,col in ipairs({Color3.new(1,1,1), Color3.new(0,0,0)}) do
            Tween:Create(border, TweenInfo.new(1), {BorderColor3=col, BorderTransparency=0.2}):Play()
            wait(1)
        end
    end
end)()

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0,8)
corner.Parent = frame

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1,0,0,30)
title.BackgroundColor3 = Color3.fromRGB(20,20,20)
title.BackgroundTransparency = 0.3
title.Text = "  RAGE Chat — tensor0101"
title.TextColor3 = Color3.new(1,1,1)
title.TextXAlignment = Enum.TextXAlignment.Left
title.Font = Enum.Font.GothamSemibold
title.TextSize = 16
title.Parent = frame

local titleCorner = Instance.new("UICorner")
titleCorner.CornerRadius = UDim.new(0,8)
titleCorner.Parent = title

local close = Instance.new("TextButton")
close.Size = UDim2.new(0,30,0,30)
close.Position = UDim2.new(1,-30,0,0)
close.BackgroundColor3 = Color3.fromRGB(200,50,50)
close.BackgroundTransparency = 0.3
close.Text = "X"
close.TextColor3 = Color3.new(1,1,1)
close.TextSize = 18
close.Font = Enum.Font.GothamBold
close.Parent = frame
close.MouseButton1Click:Connect(function() gui:Destroy() end)

local minBtn = Instance.new("TextButton")
minBtn.Size = UDim2.new(0,30,0,30)
minBtn.Position = UDim2.new(1,-60,0,0)
minBtn.BackgroundColor3 = Color3.fromRGB(70,130,200)
minBtn.BackgroundTransparency = 0.3
minBtn.Text = "–"
minBtn.TextColor3 = Color3.new(1,1,1)
minBtn.TextSize = 18
minBtn.Font = Enum.Font.GothamBold
minBtn.Parent = frame
minBtn.MouseButton1Click:Connect(function()
    isMin = not isMin
    Tween:Create(frame, TweenInfo.new(0.3), {Size = isMin and minSize or origSize}):Play()
    chatBox.Visible = not isMin
    input.Visible = not isMin
    sendBtn.Visible = not isMin
end)

local chatBox = Instance.new("ScrollingFrame")
chatBox.Size = UDim2.new(1,-10, 1,-80)
chatBox.Position = UDim2.new(0,5, 0,35)
chatBox.BackgroundColor3 = Color3.fromRGB(40,40,40)
chatBox.BackgroundTransparency = 0.2
chatBox.BorderSizePixel = 0
chatBox.CanvasSize = UDim2.new(0,0,0,0)
chatBox.ScrollBarThickness = 8
chatBox.Parent = frame

local listLayout = Instance.new("UIListLayout")
listLayout.Padding = UDim.new(0,5)
listLayout.Parent = chatBox
listLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    chatBox.CanvasSize = UDim2.new(0,0,0, listLayout.AbsoluteContentSize.Y)
end)

local input = Instance.new("TextBox")
input.Size = UDim2.new(0.7,-5, 0,30)
input.Position = UDim2.new(0,5, 1,-40)
input.BackgroundColor3 = Color3.fromRGB(50,50,50)
input.BackgroundTransparency = 0.2
input.PlaceholderText = "Сообщение..."
input.Text = ""
input.TextColor3 = Color3.new(1,1,1)
input.TextSize = 14
input.Font = Enum.Font.Gotham
input.ClearTextOnFocus = false
input.Parent = frame

local sendBtn = Instance.new("TextButton")
sendBtn.Size = UDim2.new(0.3,-10, 0,30)
sendBtn.Position = UDim2.new(0.7,0, 1,-40)
sendBtn.BackgroundColor3 = Color3.fromRGB(70,130,200)
sendBtn.BackgroundTransparency = 0.2
sendBtn.Text = "Отправить"
sendBtn.TextColor3 = Color3.new(1,1,1)
sendBtn.TextSize = 14
sendBtn.Font = Enum.Font.GothamSemibold
sendBtn.Parent = frame

local function addMsg(txt)
    local msg = Instance.new("TextLabel")
    msg.Size = UDim2.new(1,-10, 0,20)
    msg.BackgroundTransparency = 1
    msg.Text = txt
    msg.TextColor3 = Color3.new(1,1,1)
    msg.TextSize = 14
    msg.Font = Enum.Font.Gotham
    msg.TextXAlignment = Enum.TextXAlignment.Left
    msg.Parent = chatBox
end

local function notify(sender, text)
    local n = Instance.new("Frame")
    n.Size = UDim2.new(0,250, 0,60)
    n.Position = UDim2.new(1,-260, 1,-80)
    n.BackgroundColor3 = Color3.fromRGB(20,20,20)
    n.BackgroundTransparency = 0.3
    n.Parent = gui

    local nc = Instance.new("UICorner")
    nc.CornerRadius = UDim.new(0,8)
    nc.Parent = n

    local nt = Instance.new("TextLabel")
    nt.Size = UDim2.new(1,-10, 1,-10)
    nt.Position = UDim2.new(0,5, 0,5)
    nt.BackgroundTransparency = 1
    nt.Text = sender .. ": " .. text
    nt.TextColor3 = Color3.new(1,1,1)
    nt.TextSize = 14
    nt.Font = Enum.Font.Gotham
    nt.TextWrapped = true
    nt.TextXAlignment = Enum.TextXAlignment.Left
    nt.Parent = n

    Tween:Create(n, TweenInfo.new(0.3), {BackgroundTransparency = 0.3}):Play()
    wait(3)
    Tween:Create(n, TweenInfo.new(0.5), {BackgroundTransparency = 1}):Play()
    wait(0.5)
    n:Destroy()
end

local function send()
    local txt = input.Text
    if txt ~= "" then
        addMsg(player.Name .. ": " .. txt)
        notify(player.Name, txt)
        sound:Play()
        input.Text = ""
    end
end

sendBtn.MouseButton1Click:Connect(send)
input.FocusLost:Connect(function(enter) if enter then send() end end)

addMsg("Добро пожаловать. Чат от tensor0101.")
